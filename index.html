<!--
[JST 2026-01-18 15:00]  idol_quiz_which_member_fixed10_v20260118-03.html
昭和・平成・令和「どっちがメンバー？」2択クイズ（固定10問 / 外部データJS）
要件:
  - 開始ボタンは次へ左、開始後は10問終了まで非表示
  - 10問ランダム固定、出題数選択なし
  - 上部の問題/正解/不正解表示なし
  - 最後に結果表示
  - GROUPSは groups_data.js から読み込み
-->
<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>アイドル2択クイズ：どっちがメンバー？（10問）</title>
  <style>
    :root{
      --bg:#0b1020;
      --text:#eef2ff;
      --muted:rgba(238,242,255,0.70);
      --line:rgba(255,255,255,0.12);
      --ok:rgba(46,204,113,0.16);
      --ng:rgba(231,76,60,0.16);
      --shadow: 0 8px 24px rgba(0,0,0,0.35);
      --radius: 16px;
      --radius2: 12px;
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", "Hiragino Kaku Gothic ProN", Meiryo, sans-serif;
      background: radial-gradient(1200px 800px at 50% -10%, rgba(120,140,255,0.22), transparent 60%),
                  radial-gradient(900px 700px at 10% 10%, rgba(0,255,255,0.08), transparent 55%),
                  var(--bg);
      color:var(--text);

      /* ★文字を大きく（おすすめ：全体基準） */
      font-size: 20px;
      line-height: 1.55;
    }
    .wrap{ max-width: 980px; margin:0 auto; padding: 14px 12px 26px; }
    .topbar{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      padding: 10px 12px;
      background: rgba(255,255,255,0.04);
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      position: sticky; top: 10px; z-index: 10;
      backdrop-filter: blur(6px);
    }
    .title{ display:flex; flex-direction:column; gap:2px; min-width:0; }
    .title h1{
      margin:0; font-size: 20px; line-height: 1.2; letter-spacing: 0.02em;
      white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
    }
    .title .sub{
      font-size: 14px; color: var(--muted);
      white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
    }

    .main{ margin-top: 12px; display:grid; gap:12px; }
    .grid2{ display:grid; grid-template-columns: 1fr; gap:12px; }
    @media (min-width: 900px){ .grid2{ grid-template-columns: 1.15fr 0.85fr; } }

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.03));
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .card .hd{
      padding: 12px 12px;
      border-bottom: 1px solid var(--line);
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 10px;
      background: rgba(0,0,0,0.12);
    }
    .label{ font-size: 14px; color: var(--muted); margin-bottom: 6px; }
    .qtext{
      font-size: 26px; font-weight: 800; line-height: 1.28; letter-spacing: 0.02em;
      word-break: break-word;
    }
    .tag{
      font-size: 14px; padding: 7px 12px; border-radius: 999px;
      border: 1px solid var(--line); background: rgba(0,0,0,0.22);
      white-space: nowrap;
    }
    .card .bd{ padding: 12px; }

    .choices{
      display:grid;
      grid-template-columns: 1fr;
      gap: 10px;
    }
    @media (min-width: 600px){ .choices{ grid-template-columns: 1fr 1fr; } }

    .btn{
      appearance:none;
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(0,0,0,0.14));
      color: var(--text);
      border-radius: var(--radius2);

      /* ★押しやすく＆文字を大きく */
      padding: 18px 14px;

      text-align:left;
      font-size: 24px;
      line-height: 1.25;

      cursor:pointer;
      box-shadow: 0 6px 16px rgba(0,0,0,0.26);
      transition: transform 0.06s ease;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
    }
    .btn:active{ transform: scale(0.99); }
    .btn.small{
      padding: 12px 14px;
      font-size: 20px;
      background: rgba(0,0,0,0.18);
    }
    .btn.primary{
      background: linear-gradient(180deg, rgba(120,140,255,0.22), rgba(31,43,85,0.35));
      border-color: rgba(120,140,255,0.35);
    }
    .btn.disabled, .btn:disabled{
      opacity: 0.55;
      cursor: default;
      transform:none !important;
    }

    .resultBox{
      margin-top: 12px;
      border: 1px solid var(--line);
      border-radius: var(--radius2);
      padding: 12px 14px;
      background: rgba(0,0,0,0.18);
      color: var(--muted);

      /* ★結果表示を読みやすく */
      font-size: 22px;
      line-height: 1.6;

      white-space: pre-wrap;
      word-break: break-word;
    }
    .resultBox.ok{ background: rgba(46,204,113,0.16); color: rgba(238,242,255,0.92); }
    .resultBox.ng{ background: rgba(231,76,60,0.16); color: rgba(238,242,255,0.92); }

    .settings .row{
      display:flex; gap:10px; flex-wrap:wrap; align-items:center;
      margin: 10px 0;
    }
    .settings label{
      display:inline-flex; gap:10px; align-items:center;

      /* ★設定側も少し大きく */
      font-size: 18px;

      color: var(--text);
      padding: 10px 12px;
      border: 1px solid var(--line);
      border-radius: 999px;
      background: rgba(0,0,0,0.18);
      user-select:none;
    }
    .settings input[type="checkbox"]{ width: 22px; height: 22px; }

    .btnRow{
      display:flex; gap: 10px; flex-wrap: wrap;
      margin-top: 12px;
    }
    .mono{ font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; }
    .note{
      margin-top: 10px;
      color: var(--muted);
      font-size: 14px;
      text-align:center;
      opacity: 0.9;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="topbar">
      <div class="title">
        <h1>アイドル2択クイズ：どっちがメンバー？（固定10問）</h1>
        <div class="sub">「開始」でランダム10問 → 最後に結果表示</div>
      </div>
    </div>

    <div class="main grid2">
      <!-- Quiz -->
      <div class="card">
        <div class="hd">
          <div style="min-width:0;">
            <div class="label">問題</div>
            <div class="qtext" id="qText">フィルタを選んで「開始」を押してください</div>
          </div>
          <div class="tag" id="qTag">-</div>
        </div>
        <div class="bd">
          <div class="choices" id="choices"></div>

          <div class="resultBox" id="resultBox" style="display:none;"></div>

          <div class="btnRow">
            <button class="btn primary small" id="btnStart">開始</button>
            <button class="btn small" id="btnNext" disabled>次へ</button>
          </div>
        </div>
      </div>

      <!-- Settings -->
      <div class="card settings">
        <div class="hd">
          <div style="min-width:0;">
            <div class="label">設定</div>
            <div class="qtext" style="font-size:20px;">出題範囲</div>
          </div>
          <div class="tag">v20260118-03</div>
        </div>
        <div class="bd">
          <div class="label">時代フィルタ（複数選択可）</div>
          <div class="row">
            <label><input type="checkbox" id="fShowa">昭和</label>
            <label><input type="checkbox" id="fHeisei">平成</label>
            <label><input type="checkbox" id="fReiwa">令和</label>
          </div>

          <div class="label" style="margin-top:12px;">使い方</div>
          <div class="resultBox" style="display:block;">
1) フィルタを選ぶ（昭和/平成/令和）
2) 「開始」でランダム10問スタート（開始ボタンは10問終了まで非表示）
3) 2択で回答 → 判定表示 → 「次へ」
4) 10問終了後、結果表示

データは <span class="mono">groups_data.js</span> の <span class="mono">GROUPS</span> にあります。
          </div>

          <div class="note">Edge 95 互換 / 外部ライブラリ不使用</div>
        </div>
      </div>
    </div>
  </div>

  <!-- 重要: データJSを先に読み込む -->
  <script src="groups_data.js"></script>

  <script>
  /* =========================
     [GUARD-01] データ存在チェック
  ========================= */
  if(typeof GROUPS === "undefined" || !GROUPS || !GROUPS.length){
    alert("groups_data.js の読み込みに失敗しました。HTMLと同じフォルダに groups_data.js を置いてください。");
  }

  /* =========================
     [UTIL-01] 乱数/シャッフル
  ========================= */
  function randInt(n){ return Math.floor(Math.random() * n); }
  function shuffle(arr){
    for(var i=arr.length-1;i>0;i--){
      var j = randInt(i+1);
      var t = arr[i]; arr[i]=arr[j]; arr[j]=t;
    }
    return arr;
  }
  function uniq(arr){
    var m = {}; var out = [];
    for(var i=0;i<arr.length;i++){
      var k = String(arr[i]);
      if(!m[k]){ m[k]=1; out.push(arr[i]); }
    }
    return out;
  }

  /* =========================
     [STATE-01] 固定10問
  ========================= */
  var QUIZ_COUNT = 10;
  var state = {
    inPlay: false,
    deck: [],
    pos: 0,
    ok: 0,
    ng: 0,
    locked: false,
    current: null
  };

  /* =========================
     [DOM-01]
  ========================= */
  var elQText = document.getElementById("qText");
  var elQTag = document.getElementById("qTag");
  var elChoices = document.getElementById("choices");
  var elResult = document.getElementById("resultBox");

  var btnStart = document.getElementById("btnStart");
  var btnNext = document.getElementById("btnNext");

  var fShowa = document.getElementById("fShowa");
  var fHeisei = document.getElementById("fHeisei");
  var fReiwa = document.getElementById("fReiwa");

  /* =========================
     [LOGIC-01] フィルタ
  ========================= */
  function getEnabledEras(){
    var eras = [];
    if(fShowa.checked) eras.push("昭和");
    if(fHeisei.checked) eras.push("平成");
    if(fReiwa.checked) eras.push("令和");
    if(eras.length === 0){
      fShowa.checked = true;
      eras.push("昭和");
    }
    return eras;
  }
  function getGroupIndexesByEnabledEras(){
    var enabled = getEnabledEras();
    var idxs = [];
    for(var i=0;i<GROUPS.length;i++){
      if(enabled.indexOf(GROUPS[i].era) >= 0) idxs.push(i);
    }
    return idxs;
  }
  function buildDeckFixed10(){
    var cand = getGroupIndexesByEnabledEras();
    shuffle(cand);
    if(cand.length <= QUIZ_COUNT) return cand;
    return cand.slice(0, QUIZ_COUNT);
  }

  /* =========================
     [LOGIC-02] 2択問題生成
  ========================= */
  function pickCorrectMember(groupObj){
    var ms = groupObj.members || [];
    if(ms.length === 0) return "";
    return ms[randInt(ms.length)];
  }
  function pickDummyMember(correctGroupObj, correctMember){
    var sameEraPool = [];
    for(var i=0;i<GROUPS.length;i++){
      var g = GROUPS[i];
      if(!g || !g.members || !g.members.length) continue;
      if(g.era !== correctGroupObj.era) continue;
      if(g.group === correctGroupObj.group) continue;
      for(var j=0;j<g.members.length;j++){
        var m = g.members[j];
        if(m !== correctMember) sameEraPool.push(m);
      }
    }
    sameEraPool = uniq(sameEraPool);
    if(sameEraPool.length > 0) return sameEraPool[randInt(sameEraPool.length)];

    var all = [];
    for(var k=0;k<GROUPS.length;k++){
      var gg = GROUPS[k];
      if(!gg || !gg.members || !gg.members.length) continue;
      if(gg.group === correctGroupObj.group) continue;
      for(var t=0;t<gg.members.length;t++){
        var mm = gg.members[t];
        if(mm !== correctMember) all.push(mm);
      }
    }
    all = uniq(all);
    return all.length ? all[randInt(all.length)] : "";
  }
  function buildQuestion(){
    if(state.pos >= state.deck.length) return null;
    var groupIdx = state.deck[state.pos];
    var g = GROUPS[groupIdx];
    if(!g) return null;

    var correct = pickCorrectMember(g);
    var dummy = pickDummyMember(g, correct);
    var choices = shuffle([correct, dummy]);

    return {
      groupIdx: groupIdx,
      era: g.era,
      group: g.group,
      correctMember: correct,
      dummyMember: dummy,
      choices: choices
    };
  }

  /* =========================
     [UI-01]
  ========================= */
  function setResultBox(type, text){
    elResult.style.display = "block";
    elResult.className = "resultBox " + (type || "");
    elResult.textContent = text;
  }
  function clearResultBox(){
    elResult.style.display = "none";
    elResult.className = "resultBox";
    elResult.textContent = "";
  }

  function renderQuestion(){
    state.locked = false;
    btnNext.disabled = true;
    clearResultBox();

    if(state.deck.length === 0){
      elQText.textContent = "データがありません（フィルタを見直してください）";
      elQTag.textContent = "-";
      elChoices.innerHTML = "";
      return;
    }

    if(state.pos >= state.deck.length){
      renderFinal();
      return;
    }

    state.current = buildQuestion();
    if(!state.current){
      elQText.textContent = "問題の生成に失敗しました（データ不足）";
      elQTag.textContent = "-";
      elChoices.innerHTML = "";
      return;
    }

    elQText.textContent = "どっちが「" + state.current.group + "」のメンバー？（" + (state.pos+1) + "/" + state.deck.length + "）";
    elQTag.textContent = state.current.era;

    elChoices.innerHTML = "";
    for(var i=0;i<state.current.choices.length;i++){
      (function(choiceText){
        var b = document.createElement("button");
        b.className = "btn";
        b.textContent = choiceText;
        b.onclick = function(){ onAnswer(choiceText); };
        elChoices.appendChild(b);
      })(state.current.choices[i]);
    }
  }

  function onAnswer(selected){
    if(state.locked) return;
    if(!state.current) return;

    state.locked = true;

    var ok = (selected === state.current.correctMember);
    if(ok) state.ok++; else state.ng++;

    var msg = (ok ? "正解。\n" : "不正解。\n");
    msg += "グループ: " + state.current.group + "\n";
    msg += "正解: " + state.current.correctMember + "\n";
    msg += "時代: " + state.current.era + "\n";
    msg += "（参考）メンバー: " + (GROUPS[state.current.groupIdx].members || []).join(" / ");

    setResultBox(ok ? "ok" : "ng", msg);
    btnNext.disabled = false;
  }

  function renderFinal(){
    var total = state.deck.length;
    elQText.textContent = "終了：結果";
    elQTag.textContent = "完了";
    elChoices.innerHTML = "";
    btnNext.disabled = true;

    setResultBox("", "おつかれさまでした。\n\n結果: " + state.ok + " / " + total + " 正解\n不正解: " + state.ng + "\n\nもう一度やる場合は「開始」を押してください。");

    state.inPlay = false;
    btnStart.style.display = "";
  }

  /* =========================
     [CTRL-01] 開始/次へ
  ========================= */
  function startQuiz(){
    state.inPlay = true;
    state.deck = buildDeckFixed10();
    state.pos = 0;
    state.ok = 0;
    state.ng = 0;
    state.locked = false;
    state.current = null;

    btnStart.style.display = "none"; // プレイ中非表示
    renderQuestion();
  }

  btnStart.onclick = function(){ startQuiz(); };
  btnNext.onclick = function(){
    if(btnNext.disabled) return;
    state.pos++;
    renderQuestion();
  };

  /* =========================
     [BOOT-01]
  ========================= */
  (function boot(){
    fShowa.checked = true;
    fHeisei.checked = true;
    fReiwa.checked = true;

    elChoices.innerHTML = "";
    elQTag.textContent = "-";
    clearResultBox();
  })();
  </script>
</body>
</html>